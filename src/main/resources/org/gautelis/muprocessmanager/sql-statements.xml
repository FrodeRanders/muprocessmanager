<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
    <comment>
        OBSERVE:
          There exists corresponding documentation in src/main/java/eu/ensure/muprocessmanager/doc-files/sql-statements.html
    </comment>
    <entry key="STORE_PROCESS">
        INSERT INTO mu_process (correlation_id, status) VALUES (?,?)
    </entry>

    <entry key="REMOVE_PROCESS">
        DELETE FROM mu_process WHERE process_id = ?
    </entry>

    <entry key="FETCH_ABANDONED_PROCESSES">
        SELECT correlation_id, process_id, status, created, modified FROM mu_process
        WHERE status >= 5 ORDER BY modified DESC
    </entry>

    <entry key="FETCH_PROCESSES">
        SELECT correlation_id, process_id, status, created, modified FROM mu_process
        WHERE status &lt; 5 ORDER BY modified DESC
    </entry>

    <entry key="FETCH_PROCESS_RESULT_BY_CORRID">
        SELECT status, result FROM mu_process
        WHERE correlation_id = ?
    </entry>

    <entry key="COUNT_PROCESSES">
        SELECT COUNT(*), status FROM mu_process GROUP BY status
    </entry>

    <entry key="FETCH_PROCESS_STATUS_BY_CORRID">
        SELECT status FROM mu_process
        WHERE correlation_id = ?
    </entry>

    <entry key="UPDATE_PROCESS">
        UPDATE mu_process SET status = ?, result = ?, modified = CURRENT_TIMESTAMP
        WHERE process_id = ?
    </entry>

    <entry key="STORE_PROCESS_STEP">
        INSERT INTO mu_process_step (process_id, step_id, class_name, method_name, parameters, previous_state) VALUES (?,?,?,?,?,?)
    </entry>

    <entry key="REMOVE_PROCESS_STEP">
        DELETE FROM mu_process_step
        WHERE process_id = ? AND step_id = ?
    </entry>

    <entry key="REMOVE_PROCESS_STEPS">
        DELETE FROM mu_process_step
        WHERE process_id = ?
    </entry>

    <entry key="FETCH_PROCESS_STEPS">
        SELECT proc.correlation_id, step.step_id, step.class_name, step.method_name, step.parameters, step.retries, step.previous_state
        FROM mu_process_step step
        INNER JOIN mu_process proc ON proc.process_id = step.process_id
        WHERE proc.process_id = ?
        ORDER BY step_id DESC
    </entry>

    <entry key="INCREMENT_PROCESS_STEP_RETRIES">
        UPDATE mu_process_step SET retries = retries + 1
        WHERE process_id = ?
        AND step_id = ?
    </entry>
</properties>



